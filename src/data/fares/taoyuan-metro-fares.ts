/**
 * Taoyuan Metro (Airport MRT) fare data.
 * Official fares from: https://www.tymetro.com.tw/tymetro-new/tw/_images/document/travel-guide/price.pdf
 */

import { TAOYUAN_METRO_STATIONS } from '../stations/taoyuan-metro-stations';

/**
 * Fare matrix for Taoyuan Metro (Official).
 * Index: A1=0, A2=1, A3=2, A4=3, A5=4, A6=5, A7=6, A8=7, A9=8, A10=9,
 *        A11=10, A12=11, A13=12, A14a=13, A15=14, A16=15, A17=16, A18=17,
 *        A19=18, A20=19, A21=20, A22=21
 */
const FARE_MATRIX: number[][] = [
  // A1 台北車站
  [0, 25, 30, 30, 30, 45, 65, 75, 75, 115, 125, 160, 160, 160, 155, 155, 155, 155, 155, 155, 155, 155],
  // A2 三重
  [25, 0, 25, 25, 25, 35, 50, 55, 55, 95, 105, 140, 140, 140, 145, 155, 155, 155, 155, 155, 155, 155],
  // A3 新北產業園區
  [30, 25, 0, 25, 25, 25, 25, 30, 30, 70, 80, 115, 115, 115, 120, 130, 135, 145, 150, 155, 155, 155],
  // A4 新莊副都心
  [30, 25, 25, 0, 25, 25, 25, 30, 30, 70, 80, 115, 115, 115, 120, 130, 135, 145, 150, 155, 155, 155],
  // A5 泰山
  [30, 25, 25, 25, 0, 25, 25, 30, 30, 70, 80, 115, 115, 115, 120, 130, 135, 145, 150, 155, 155, 155],
  // A6 泰山貴和
  [45, 35, 25, 25, 25, 0, 25, 25, 25, 55, 65, 80, 80, 80, 85, 95, 105, 110, 120, 135, 155, 155],
  // A7 體育大學
  [65, 50, 25, 25, 25, 25, 0, 25, 25, 35, 45, 60, 60, 60, 65, 75, 85, 90, 100, 115, 120, 125],
  // A8 長庚醫院
  [75, 55, 30, 30, 30, 25, 25, 0, 25, 35, 45, 60, 60, 60, 65, 75, 85, 90, 100, 115, 120, 125],
  // A9 林口
  [75, 55, 30, 30, 30, 25, 25, 25, 0, 35, 45, 60, 60, 60, 65, 75, 85, 90, 100, 115, 120, 125],
  // A10 山鼻
  [115, 95, 70, 70, 70, 55, 35, 35, 35, 0, 25, 25, 25, 25, 30, 40, 45, 55, 60, 75, 80, 85],
  // A11 坑口
  [125, 105, 80, 80, 80, 65, 45, 45, 45, 25, 0, 25, 25, 25, 25, 30, 35, 45, 50, 65, 70, 75],
  // A12 機場第一航廈
  [160, 140, 115, 115, 115, 80, 60, 60, 60, 25, 25, 0, 25, 25, 25, 25, 25, 35, 40, 55, 65, 65],
  // A13 機場第二航廈
  [160, 140, 115, 115, 115, 80, 60, 60, 60, 25, 25, 25, 0, 25, 25, 25, 25, 35, 40, 55, 65, 65],
  // A14a 機場旅館
  [160, 140, 115, 115, 115, 80, 60, 60, 60, 25, 25, 25, 25, 0, 25, 25, 25, 35, 40, 55, 65, 65],
  // A15 大園
  [155, 145, 120, 120, 120, 85, 65, 65, 65, 30, 25, 25, 25, 25, 0, 25, 25, 25, 30, 40, 50, 55],
  // A16 橫山
  [155, 155, 130, 130, 130, 95, 75, 75, 75, 40, 30, 25, 25, 25, 25, 0, 25, 25, 25, 30, 40, 45],
  // A17 領航
  [155, 155, 135, 135, 135, 105, 85, 85, 85, 45, 35, 25, 25, 25, 25, 25, 0, 25, 25, 25, 30, 35],
  // A18 高鐵桃園站
  [155, 155, 145, 145, 145, 110, 90, 90, 90, 55, 45, 35, 35, 35, 25, 25, 25, 0, 25, 25, 25, 30],
  // A19 桃園體育園區
  [155, 155, 150, 150, 150, 120, 100, 100, 100, 60, 50, 40, 40, 40, 30, 25, 25, 25, 0, 25, 25, 25],
  // A20 興南
  [155, 155, 155, 155, 155, 135, 115, 115, 115, 75, 65, 55, 55, 55, 40, 30, 25, 25, 25, 0, 25, 25],
  // A21 環北
  [155, 155, 155, 155, 155, 155, 120, 120, 120, 80, 70, 65, 65, 65, 50, 40, 30, 25, 25, 25, 0, 25],
  // A22 老街溪
  [155, 155, 155, 155, 155, 155, 125, 125, 125, 85, 75, 65, 65, 65, 55, 45, 35, 30, 25, 25, 25, 0]
];

/**
 * Station name to index mapping.
 */
const STATION_INDEX: Record<string, number> = {};
TAOYUAN_METRO_STATIONS.forEach((station, index) => {
  STATION_INDEX[station.name] = index;
});

/**
 * Get fare between two Taoyuan Metro stations.
 *
 * @param fromStation - Departure station name
 * @param toStation - Arrival station name
 * @returns Fare in TWD, or 0 if stations not found
 */
export function getTaoyuanMetroFare(fromStation: string, toStation: string): number {
  const fromIndex = STATION_INDEX[fromStation];
  const toIndex = STATION_INDEX[toStation];

  if (fromIndex === undefined || toIndex === undefined) {
    return 0;
  }

  return FARE_MATRIX[fromIndex][toIndex];
}
